\begin{algorithmic}[1]
	\Require $\{\ten{X}(n)\}_n^N$, $\{c_n\}_n^N$,
	$(R_1,R_2,\ldots,R_K)$, $I_\text{max}$, $\epsilon$
	\State $\mat{U}_k \gets $ orthonormal matrix $\in \mathbb{R}^{D_k\times R_k}
		\ \forall k$
	\State $\mat{S}_{k,\text{t}} \gets
		\textstyle{\sum_n^N}\mat{X}_k(n)\cdot\mat{X}_k^\intercal(n)\ \forall k$
	\State $i\gets 1$
	\Repeat
	\For{$k=1,2\ldots,K$}
	\State $\ten{G}(n)_{-k} \gets \ten{X}(n)\mmprs{\mat{U}}{k} \ \forall n$
	\State $\mat{S}_{-k,\text{w}} \gets
		\textstyle{\sum_n^N}\tilde{\mat{G}}_{-k,k}(n)\cdot\tilde{\mat{G}}_{-k,k}^\intercal(n)$
	\State $\mat{S}_{-k,\text{b}} \gets
		\textstyle{\sum_c^C}N_c\tilde{\bar{\mat{G}}}_{-k,k}(c)\cdot\tilde{\bar{\mat{G}}}_{-k,k}^\intercal(c)$
	\State $\varphi_k\gets\tr\left(\mat{U}_k^\intercal \mat{S}_{-k,\text{b}}\mat{U}_k\right)/\tr\left(\mat{U}_k^\intercal\mat{S}_{-k\text{w}}\mat{U}_k\right)$
	\State $\mat{V}_k\gets$ \parbox[t]{5cm}{largest magnitude $R_k$ \\ eigenvectors of
	$\mat{S}_{-k,\text{b}} - \varphi_k\mat{S}_{-k,\text{w}}$}
	\State $\mat{U}_k \gets$ \parbox[t]{5cm}{largest magnitude $R_k$ \\
	eigenvectors of $\mat{V}_k\mat{V}_k^\intercal\mat{S}_{k,\text{t}}\mat{V}_k\mat{V}_k^\intercal$}
	\EndFor
	\State $i\gets i+1$
	\Until{$i=I_\text{max}$ or $||\mat{U}_k^{(i)}-\mat{U}_k^{(i-1)}||<\epsilon
		\ \forall k$}
\end{algorithmic}
